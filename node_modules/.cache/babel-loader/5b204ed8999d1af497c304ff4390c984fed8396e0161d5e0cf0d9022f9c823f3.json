{"ast":null,"code":"var _jsxFileName = \"/Users/nishidanaoto/ateori-app/src/components/pages/RankingPage.tsx\",\n  _s = $RefreshSig$();\nimport { memo, useContext, useEffect, useRef } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport { Spinner, Wrap, WrapItem, Center } from \"@chakra-ui/react\";\nimport { LoginUserContext } from '../../providers/LoginUserProvider';\nimport { useRankingAllUsers } from \"../../hooks/rankingAllUsers\";\nimport { RankingCard } from \"../organisms/ranking/rankingCard\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const RankingPage = /*#__PURE__*/_s( /*#__PURE__*/memo(_c = _s(() => {\n  _s();\n  console.log(\"RankingPage rendered\");\n  const {\n    loginUser,\n    setLoginUser\n  } = useContext(LoginUserContext);\n  const timerId = useRef(null);\n  const navigate = useNavigate();\n  const {\n    getRankings,\n    users,\n    loading,\n    error\n  } = useRankingAllUsers();\n\n  // 自動ログアウトの時間（ミリ秒）\n  const autoLogoutTime = 600000; // 10分\n  //const autoLogoutTime = 10000; // 10秒\n\n  useEffect(() => {\n    const resetTimer = () => {\n      // タイマーをリセット\n      if (timerId.current) {\n        clearTimeout(timerId.current);\n      }\n\n      // 新たなタイマーをセット\n      timerId.current = setTimeout(() => {\n        // ログアウト処理（例: setLoginUser(null)）\n        setLoginUser(null);\n\n        // トップページにリダイレクト\n        navigate('/');\n      }, autoLogoutTime);\n    };\n\n    // ユーザーがアクションを起こすたびにタイマーをリセット\n    const resetTimerOnAction = () => {\n      resetTimer();\n    };\n\n    // 初回実行時にタイマーをセット\n    resetTimer();\n\n    // ユーザーのアクション（例: クリック）があった場合にタイマーをリセット\n    document.addEventListener('click', resetTimerOnAction);\n    return () => {\n      // コンポーネントがアンマウントされたときにクリア\n      if (timerId.current) {\n        clearTimeout(timerId.current);\n      }\n      document.removeEventListener('click', resetTimerOnAction);\n    };\n  }, [setLoginUser, navigate, timerId]);\n\n  // loginUserが存在するかどうかのチェック\n  useEffect(() => {\n    // loginUserが存在しない場合、トップページに遷移\n    if (!loginUser) {\n      navigate('/');\n    }\n  }, [loginUser, navigate]);\n  useEffect(() => {\n    console.log(\"useEffect is called\");\n    const fetchData = async () => {\n      getRankings();\n    };\n    fetchData();\n  }, [getRankings]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\u30E9\\u30F3\\u30AD\\u30F3\\u30B0\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(Center, {\n      h: \"100vh\",\n      children: /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }, this) : error ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: \"red\"\n        },\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this)\n    }, void 0, false) : /*#__PURE__*/_jsxDEV(Wrap, {\n      p: {\n        base: 4,\n        md: 10\n      },\n      children: users.map(user => /*#__PURE__*/_jsxDEV(WrapItem, {\n        mx: \"auto\",\n        children: /*#__PURE__*/_jsxDEV(RankingCard, {\n          rank: user.rank,\n          userName: user.name,\n          count: user.count\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 15\n        }, this)\n      }, user.rank, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}, \"3WUlwal4Jo7MaaT12sNNcY1sqck=\", false, function () {\n  return [useNavigate, useRankingAllUsers];\n})), \"3WUlwal4Jo7MaaT12sNNcY1sqck=\", false, function () {\n  return [useNavigate, useRankingAllUsers];\n});\n_c2 = RankingPage;\nvar _c, _c2;\n$RefreshReg$(_c, \"RankingPage$memo\");\n$RefreshReg$(_c2, \"RankingPage\");","map":{"version":3,"names":["memo","useContext","useEffect","useRef","useNavigate","Spinner","Wrap","WrapItem","Center","LoginUserContext","useRankingAllUsers","RankingCard","jsxDEV","_jsxDEV","Fragment","_Fragment","RankingPage","_s","_c","console","log","loginUser","setLoginUser","timerId","navigate","getRankings","users","loading","error","autoLogoutTime","resetTimer","current","clearTimeout","setTimeout","resetTimerOnAction","document","addEventListener","removeEventListener","fetchData","children","fileName","_jsxFileName","lineNumber","columnNumber","h","style","color","p","base","md","map","user","mx","rank","userName","name","count","_c2","$RefreshReg$"],"sources":["/Users/nishidanaoto/ateori-app/src/components/pages/RankingPage.tsx"],"sourcesContent":["import {memo, useContext, useEffect, useRef } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport {\n  Spinner,\n  Wrap,\n  WrapItem,\n  Center,\n} from \"@chakra-ui/react\";\n\nimport { LoginUserContext } from '../../providers/LoginUserProvider';\nimport {useRankingAllUsers } from \"../../hooks/rankingAllUsers\";\nimport { RankingCard } from \"../organisms/ranking/rankingCard\";\nimport { User } from \"../../types/api/user\";\n\nexport const RankingPage = memo(() =>{\n  console.log(\"RankingPage rendered\");\n  const { loginUser, setLoginUser } = useContext(LoginUserContext);\n  const timerId = useRef<NodeJS.Timeout | null>(null);\n  const navigate = useNavigate();\n  const { getRankings, users, loading, error } = useRankingAllUsers();\n\n\n  // 自動ログアウトの時間（ミリ秒）\n  const autoLogoutTime = 600000; // 10分\n  //const autoLogoutTime = 10000; // 10秒\n\n  useEffect(() => {\n    const resetTimer = () => {\n      // タイマーをリセット\n      if (timerId.current) {\n        clearTimeout(timerId.current);\n      }\n\n      // 新たなタイマーをセット\n      timerId.current = setTimeout(() => {\n        // ログアウト処理（例: setLoginUser(null)）\n        setLoginUser(null);\n\n        // トップページにリダイレクト\n        navigate('/');\n      }, autoLogoutTime);\n    };\n\n    // ユーザーがアクションを起こすたびにタイマーをリセット\n    const resetTimerOnAction = () => {\n      resetTimer();\n    };\n\n    // 初回実行時にタイマーをセット\n    resetTimer();\n\n    // ユーザーのアクション（例: クリック）があった場合にタイマーをリセット\n    document.addEventListener('click', resetTimerOnAction);\n\n    return () => {\n      // コンポーネントがアンマウントされたときにクリア\n      if (timerId.current) {\n        clearTimeout(timerId.current);\n      }\n      document.removeEventListener('click', resetTimerOnAction);\n    };    \n  }, [setLoginUser, navigate, timerId]);\n\n   // loginUserが存在するかどうかのチェック\n   useEffect(() => {\n    // loginUserが存在しない場合、トップページに遷移\n    if (!loginUser) {\n      navigate('/');\n    }\n  }, [loginUser, navigate]);\n\n  useEffect(() => {\n    console.log(\"useEffect is called\");\n    const fetchData = async () => {\n      getRankings();\n    };\n    fetchData();\n  \n  }, [getRankings]);\n  \n  \n  return (\n    <>\n      <p>ランキング</p>\n      {loading ? (\n        <Center h=\"100vh\">\n          <Spinner />\n        </Center>\n      ) : error ? (\n        <>\n          <div style={{ color: \"red\" }}>{error}</div>\n        </>\n      ) : (\n        <Wrap p={{ base: 4, md: 10 }}>\n          {users.map((user: User) => (\n            <WrapItem key={user.rank} mx=\"auto\">\n              <RankingCard rank={user.rank} userName={user.name} count={user.count} />\n            </WrapItem>\n          ))}\n        </Wrap>\n      )}\n    </>\n  )});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}