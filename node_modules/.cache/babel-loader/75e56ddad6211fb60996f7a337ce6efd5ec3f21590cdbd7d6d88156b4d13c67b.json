{"ast":null,"code":"var _jsxFileName = \"/Users/nishidanaoto/ateori-app/src/components/pages/RankingPage.tsx\",\n  _s = $RefreshSig$();\nimport { memo, useContext, useEffect, useRef } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport { Spinner, Wrap, WrapItem, Center, Text } from \"@chakra-ui/react\";\nimport { LoginUserContext } from '../../providers/LoginUserProvider';\nimport { useRankingAllUsers } from \"../../hooks/rankingAllUsers\";\nimport { RankingCard } from \"../organisms/ranking/rankingCard\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const RankingPage = /*#__PURE__*/_s( /*#__PURE__*/memo(_c = _s(() => {\n  _s();\n  const {\n    loginUser,\n    setLoginUser\n  } = useContext(LoginUserContext);\n  const timerId = useRef(null);\n  const navigate = useNavigate();\n  const {\n    getRankings,\n    users,\n    loading,\n    error\n  } = useRankingAllUsers();\n\n  // 自動ログアウトの時間（ミリ秒）\n  const autoLogoutTime = 600000; // 10分\n  //const autoLogoutTime = 10000; // 10秒\n\n  useEffect(() => {\n    const resetTimer = () => {\n      // タイマーをリセット\n      if (timerId.current) {\n        clearTimeout(timerId.current);\n      }\n\n      // 新たなタイマーをセット\n      timerId.current = setTimeout(() => {\n        // ログアウト処理（例: setLoginUser(null)）\n        setLoginUser(null);\n\n        // トップページにリダイレクト\n        navigate('/');\n      }, autoLogoutTime);\n    };\n\n    // ユーザーがアクションを起こすたびにタイマーをリセット\n    const resetTimerOnAction = () => {\n      resetTimer();\n    };\n\n    // 初回実行時にタイマーをセット\n    resetTimer();\n\n    // ユーザーのアクション（例: クリック）があった場合にタイマーをリセット\n    document.addEventListener('click', resetTimerOnAction);\n    return () => {\n      // コンポーネントがアンマウントされたときにクリア\n      if (timerId.current) {\n        clearTimeout(timerId.current);\n      }\n      document.removeEventListener('click', resetTimerOnAction);\n    };\n  }, [setLoginUser, navigate, timerId]);\n\n  // loginUserが存在するかどうかのチェック\n  useEffect(() => {\n    // loginUserが存在しない場合、トップページに遷移\n    if (!loginUser) {\n      navigate('/');\n    }\n  }, [loginUser, navigate]);\n  useEffect(() => {\n    const fetchData = async () => {\n      getRankings();\n    };\n    fetchData();\n  }, [getRankings]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Text, {\n      textAlign: \"center\",\n      fontSize: \"xl\",\n      mt: 4,\n      fontWeight: \"bold\",\n      children: \"\\u30E9\\u30F3\\u30AD\\u30F3\\u30B0\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 10\n    }, this), loading ? /*#__PURE__*/_jsxDEV(Center, {\n      h: \"100vh\",\n      children: /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }, this) : error ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: \"red\"\n        },\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this)\n    }, void 0, false) : /*#__PURE__*/_jsxDEV(Wrap, {\n      p: {\n        base: 4,\n        md: 10\n      },\n      children: users.map(user => /*#__PURE__*/_jsxDEV(WrapItem, {\n        mx: \"auto\",\n        children: /*#__PURE__*/_jsxDEV(RankingCard, {\n          rank: user.rank,\n          userName: user.name,\n          count: user.count\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 15\n        }, this)\n      }, user.rank, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}, \"3WUlwal4Jo7MaaT12sNNcY1sqck=\", false, function () {\n  return [useNavigate, useRankingAllUsers];\n})), \"3WUlwal4Jo7MaaT12sNNcY1sqck=\", false, function () {\n  return [useNavigate, useRankingAllUsers];\n});\n_c2 = RankingPage;\nvar _c, _c2;\n$RefreshReg$(_c, \"RankingPage$memo\");\n$RefreshReg$(_c2, \"RankingPage\");","map":{"version":3,"names":["memo","useContext","useEffect","useRef","useNavigate","Spinner","Wrap","WrapItem","Center","Text","LoginUserContext","useRankingAllUsers","RankingCard","jsxDEV","_jsxDEV","Fragment","_Fragment","RankingPage","_s","_c","loginUser","setLoginUser","timerId","navigate","getRankings","users","loading","error","autoLogoutTime","resetTimer","current","clearTimeout","setTimeout","resetTimerOnAction","document","addEventListener","removeEventListener","fetchData","children","textAlign","fontSize","mt","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","h","style","color","p","base","md","map","user","mx","rank","userName","name","count","_c2","$RefreshReg$"],"sources":["/Users/nishidanaoto/ateori-app/src/components/pages/RankingPage.tsx"],"sourcesContent":["import {memo, useContext, useEffect, useRef } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport {\n  Spinner,\n  Wrap,\n  WrapItem,\n  Center,\n  Text,\n} from \"@chakra-ui/react\";\n\nimport { LoginUserContext } from '../../providers/LoginUserProvider';\nimport {useRankingAllUsers } from \"../../hooks/rankingAllUsers\";\nimport { RankingCard } from \"../organisms/ranking/rankingCard\";\nimport { User } from \"../../types/api/user\";\n\nexport const RankingPage = memo(() =>{\n  const { loginUser, setLoginUser } = useContext(LoginUserContext);\n  const timerId = useRef<NodeJS.Timeout | null>(null);\n  const navigate = useNavigate();\n  const { getRankings, users, loading, error } = useRankingAllUsers();\n\n\n  // 自動ログアウトの時間（ミリ秒）\n  const autoLogoutTime = 600000; // 10分\n  //const autoLogoutTime = 10000; // 10秒\n\n  useEffect(() => {\n    const resetTimer = () => {\n      // タイマーをリセット\n      if (timerId.current) {\n        clearTimeout(timerId.current);\n      }\n\n      // 新たなタイマーをセット\n      timerId.current = setTimeout(() => {\n        // ログアウト処理（例: setLoginUser(null)）\n        setLoginUser(null);\n\n        // トップページにリダイレクト\n        navigate('/');\n      }, autoLogoutTime);\n    };\n\n    // ユーザーがアクションを起こすたびにタイマーをリセット\n    const resetTimerOnAction = () => {\n      resetTimer();\n    };\n\n    // 初回実行時にタイマーをセット\n    resetTimer();\n\n    // ユーザーのアクション（例: クリック）があった場合にタイマーをリセット\n    document.addEventListener('click', resetTimerOnAction);\n\n    return () => {\n      // コンポーネントがアンマウントされたときにクリア\n      if (timerId.current) {\n        clearTimeout(timerId.current);\n      }\n      document.removeEventListener('click', resetTimerOnAction);\n    };    \n  }, [setLoginUser, navigate, timerId]);\n\n   // loginUserが存在するかどうかのチェック\n   useEffect(() => {\n    // loginUserが存在しない場合、トップページに遷移\n    if (!loginUser) {\n      navigate('/');\n    }\n  }, [loginUser, navigate]);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      getRankings();\n    };\n    fetchData();\n  \n  }, [getRankings]);\n  \n  \n  return (\n    <>\n         <Text textAlign=\"center\" fontSize=\"xl\" mt={4} fontWeight=\"bold\">\n        ランキング\n      </Text>\n      {loading ? (\n        <Center h=\"100vh\">\n          <Spinner />\n        </Center>\n      ) : error ? (\n        <>\n          <div style={{ color: \"red\" }}>{error}</div>\n        </>\n      ) : (\n        <Wrap p={{ base: 4, md: 10 }}>\n          {users.map((user: User) => (\n            <WrapItem key={user.rank} mx=\"auto\">\n              <RankingCard rank={user.rank} userName={user.name} count={user.count} />\n            </WrapItem>\n          ))}\n        </Wrap>\n      )}\n    </>\n  )});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}