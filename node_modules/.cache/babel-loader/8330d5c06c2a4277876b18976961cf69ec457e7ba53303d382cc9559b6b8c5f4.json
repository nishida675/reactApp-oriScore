{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback, useState } from \"react\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useMessage } from \"./useMessage\";\nimport { useLoginUser } from \"../hooks/useLoginUser\";\nexport const useAuth = () => {\n  _s();\n  const history = useNavigate();\n  const {\n    showMessage\n  } = useMessage();\n  const {\n    setLoginUser\n  } = useLoginUser();\n  const apiUrl = \"http://localhost:8080/api/authLogin\";\n  const [loading, setLoading] = useState(false);\n  const login = useCallback((name, pass) => {\n    setLoading(true);\n    axios.post(apiUrl, {\n      name: name,\n      pass: pass\n    }).then(res => {\n      if (res.data) {\n        var _res$data$, _res$data$2, _res$data$3, _res$data$4;\n        const isAdmin = res.data.id === 1 ? true : false;\n        setLoginUser({\n          id: (_res$data$ = res.data[0]) === null || _res$data$ === void 0 ? void 0 : _res$data$.id,\n          name: (_res$data$2 = res.data[0]) === null || _res$data$2 === void 0 ? void 0 : _res$data$2.name,\n          pass: (_res$data$3 = res.data[0]) === null || _res$data$3 === void 0 ? void 0 : _res$data$3.pass,\n          count: (_res$data$4 = res.data[0]) === null || _res$data$4 === void 0 ? void 0 : _res$data$4.count,\n          isAdmin: isAdmin\n        });\n        showMessage({\n          title: \"ログインしました\",\n          status: \"success\"\n        });\n        history(\"/vote\");\n      } else {\n        showMessage({\n          title: \"ユーザーが見つかりません\",\n          status: \"error\"\n        });\n        setLoading(false);\n      }\n    }).catch(() => {\n      showMessage({\n        title: \"ログインできません\",\n        status: \"error\"\n      });\n      setLoading(false);\n    });\n  }, [history, showMessage, setLoginUser]);\n  return {\n    login,\n    loading\n  };\n};\n_s(useAuth, \"iftbK+eEsCeZcXXyBedgpHWrfCg=\", false, function () {\n  return [useNavigate, useMessage, useLoginUser];\n});","map":{"version":3,"names":["useCallback","useState","axios","useNavigate","useMessage","useLoginUser","useAuth","_s","history","showMessage","setLoginUser","apiUrl","loading","setLoading","login","name","pass","post","then","res","data","_res$data$","_res$data$2","_res$data$3","_res$data$4","isAdmin","id","count","title","status","catch"],"sources":["/Users/nishidanaoto/ateori-app/src/hooks/useAuth.ts"],"sourcesContent":["import { useCallback, useState } from \"react\";\nimport axios from \"axios\";\n\nimport { useNavigate } from \"react-router-dom\";\nimport { User } from \"../types/api/user\";\nimport { useMessage } from \"./useMessage\";\nimport { useLoginUser } from \"../hooks/useLoginUser\";\n\n\nexport const useAuth = () => {\n  const history = useNavigate();\n  const { showMessage } = useMessage();\n  const { setLoginUser } = useLoginUser();\n  const apiUrl = \"http://localhost:8080/api/authLogin\";\n\n  const [loading, setLoading] = useState(false);\n  const login = useCallback(\n    (name: string, pass: string) => {\n      setLoading(true);\n      axios\n      .post<User>(apiUrl, {\n        name: name,\n        pass: pass\n      })\n        .then((res) => {\n          if (res.data) {\n            const isAdmin = res.data.id === 1 ? true : false;\n            setLoginUser({\n              id: res.data[0]?.id,\n              name: res.data[0]?.name,\n              pass: res.data[0]?.pass,\n              count: res.data[0]?.count,\n              isAdmin: isAdmin\n            });\n            showMessage({ title: \"ログインしました\", status: \"success\" });\n            history(\"/vote\");\n          } else {\n            showMessage({ title: \"ユーザーが見つかりません\", status: \"error\" });\n            setLoading(false);\n          }\n        })\n        .catch(() => {\n          showMessage({ title: \"ログインできません\", status: \"error\" });\n          setLoading(false);\n        });\n    },\n    [history, showMessage, setLoginUser]\n  );\n  return { login, loading };\n};"],"mappings":";AAAA,SAASA,WAAW,EAAEC,QAAQ,QAAQ,OAAO;AAC7C,OAAOC,KAAK,MAAM,OAAO;AAEzB,SAASC,WAAW,QAAQ,kBAAkB;AAE9C,SAASC,UAAU,QAAQ,cAAc;AACzC,SAASC,YAAY,QAAQ,uBAAuB;AAGpD,OAAO,MAAMC,OAAO,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC3B,MAAMC,OAAO,GAAGL,WAAW,CAAC,CAAC;EAC7B,MAAM;IAAEM;EAAY,CAAC,GAAGL,UAAU,CAAC,CAAC;EACpC,MAAM;IAAEM;EAAa,CAAC,GAAGL,YAAY,CAAC,CAAC;EACvC,MAAMM,MAAM,GAAG,qCAAqC;EAEpD,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGZ,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAMa,KAAK,GAAGd,WAAW,CACvB,CAACe,IAAY,EAAEC,IAAY,KAAK;IAC9BH,UAAU,CAAC,IAAI,CAAC;IAChBX,KAAK,CACJe,IAAI,CAAON,MAAM,EAAE;MAClBI,IAAI,EAAEA,IAAI;MACVC,IAAI,EAAEA;IACR,CAAC,CAAC,CACCE,IAAI,CAAEC,GAAG,IAAK;MACb,IAAIA,GAAG,CAACC,IAAI,EAAE;QAAA,IAAAC,UAAA,EAAAC,WAAA,EAAAC,WAAA,EAAAC,WAAA;QACZ,MAAMC,OAAO,GAAGN,GAAG,CAACC,IAAI,CAACM,EAAE,KAAK,CAAC,GAAG,IAAI,GAAG,KAAK;QAChDhB,YAAY,CAAC;UACXgB,EAAE,GAAAL,UAAA,GAAEF,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,cAAAC,UAAA,uBAAXA,UAAA,CAAaK,EAAE;UACnBX,IAAI,GAAAO,WAAA,GAAEH,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,cAAAE,WAAA,uBAAXA,WAAA,CAAaP,IAAI;UACvBC,IAAI,GAAAO,WAAA,GAAEJ,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,cAAAG,WAAA,uBAAXA,WAAA,CAAaP,IAAI;UACvBW,KAAK,GAAAH,WAAA,GAAEL,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,cAAAI,WAAA,uBAAXA,WAAA,CAAaG,KAAK;UACzBF,OAAO,EAAEA;QACX,CAAC,CAAC;QACFhB,WAAW,CAAC;UAAEmB,KAAK,EAAE,UAAU;UAAEC,MAAM,EAAE;QAAU,CAAC,CAAC;QACrDrB,OAAO,CAAC,OAAO,CAAC;MAClB,CAAC,MAAM;QACLC,WAAW,CAAC;UAAEmB,KAAK,EAAE,cAAc;UAAEC,MAAM,EAAE;QAAQ,CAAC,CAAC;QACvDhB,UAAU,CAAC,KAAK,CAAC;MACnB;IACF,CAAC,CAAC,CACDiB,KAAK,CAAC,MAAM;MACXrB,WAAW,CAAC;QAAEmB,KAAK,EAAE,WAAW;QAAEC,MAAM,EAAE;MAAQ,CAAC,CAAC;MACpDhB,UAAU,CAAC,KAAK,CAAC;IACnB,CAAC,CAAC;EACN,CAAC,EACD,CAACL,OAAO,EAAEC,WAAW,EAAEC,YAAY,CACrC,CAAC;EACD,OAAO;IAAEI,KAAK;IAAEF;EAAQ,CAAC;AAC3B,CAAC;AAACL,EAAA,CAxCWD,OAAO;EAAA,QACFH,WAAW,EACHC,UAAU,EACTC,YAAY;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}